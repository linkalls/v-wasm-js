import{C as e,D as t,E as n,O as r,S as i,T as a,_ as o,b as s,c,d as l,f as u,g as d,h as f,k as p,l as m,m as h,n as g,p as _,r as v,s as y,u as b,v as x,w as S,x as ee,y as C}from"./jsx-runtime-BsB6KTaB.mjs";const w=new WeakMap,T=new WeakMap;function E(e,n,r){let i=w.get(e);i||(i=new Map,w.set(e,i));let a=i.get(n);return a||(a=t(r),i.set(n,a)),a}function D(e){if(T.has(e))return T.get(e);let t=new Proxy(e,{get(e,t,n){let r=Reflect.get(e,t,n);return typeof t==`symbol`?r:(h(E(e,t,r)),typeof r==`object`&&r?D(r):r)},set(e,t,n,r){return Reflect.get(e,t,r)!==n&&(Reflect.set(e,t,n,r),s(E(e,t,n),n)),!0},deleteProperty(e,t){let n=Reflect.deleteProperty(e,t);return n&&s(E(e,t,void 0),void 0),n}});return T.set(e,t),t}function O(e){let t=D(e);return[t,e=>{e(t)}]}function k(e,t){let n=t||Symbol(`context`);return{id:n,defaultValue:e,Provider:e=>{let t=d(),r=Object.create(t||null);return r[n]=e.value,C(r,()=>c(e.children))}}}function A(e){let t=f(e.id);return t===void 0?e.defaultValue:t}function j(e){return typeof e==`function`?e():e}function M(e){let t=document.createComment(`show`),n=[],r=!1,i=()=>{let t=Array.isArray(e.children)?e.children[0]:e.children;return c(typeof t==`function`?t():t)},a=()=>{if(!e.fallback)return null;let t=Array.isArray(e.fallback)?e.fallback[0]:e.fallback;return c(typeof t==`function`?t():t)},o=()=>{let o=j(e.when),s=t.parentNode;if(s)if(o){if(r&&n.length>0){for(let e of n)g(e),e.parentNode?.removeChild(e);n=[]}if(n.length===0||r){let e=i();e&&(e instanceof DocumentFragment?(n=Array.from(e.childNodes),s.insertBefore(e,t.nextSibling)):e instanceof Node&&(n=[e],s.insertBefore(e,t.nextSibling))),r=!1}}else{if(n.length>0&&!r){for(let e of n)g(e),e.parentNode?.removeChild(e);n=[]}if(e.fallback&&!r){let e=a();e&&(e instanceof DocumentFragment?(n=Array.from(e.childNodes),s.insertBefore(e,t.nextSibling)):e instanceof Node&&(n=[e],s.insertBefore(e,t.nextSibling)),r=!0)}else e.fallback||(r=!1)}},s=document.createDocumentFragment();return s.appendChild(t),y(t,()=>_(o)),p(o),s}function N(e){let t=document.createComment(`for`),n=new Map,r=[],i=e.key||((e,t)=>t),a=Array.isArray(e.children)?e.children[0]:e.children,o=document.createDocumentFragment();o.appendChild(t);let s=()=>{let s=j(e.each),l=t.parentNode||o,u=s.length,d=r.length;if(u===0&&d===0)return;let f=Array(u),p=0;for(;p<u;)f[p]=i(s[p],p),p++;if(d>0&&u>=d){let e=!0;for(let t=0;t<d;t++)if(r[t]!==f[t]){e=!1;break}if(e){let e=d&&n.get(r[d-1])?.node||t;for(let t=d;t<u;t++){let r=f[t],i={value:t},o=()=>i.value,u=c(a(s[t],o));if(u instanceof Node){let a={node:u,item:s[t],index:t,indexFn:o,indexRef:i};n.set(r,a),l.insertBefore(u,e.nextSibling),e=u}}r=f;return}}if(d>0&&u<=d){let e=0;for(let t=0;t<d&&e<u;t++)r[t]===f[e]&&e++;if(e===u){let e=new Set(f);for(let t of r)if(!e.has(t)){let e=n.get(t);e&&(g(e.node),e.node.parentNode?.removeChild(e.node),n.delete(t))}let i=t;for(let e=0;e<u;e++){let t=f[e],r=n.get(t);r&&(r.index=e,r.indexRef.value=e,i.nextSibling!==r.node&&l.insertBefore(r.node,i.nextSibling),i=r.node)}r=f;return}}let m=new Set(f);for(let e of r)if(!m.has(e)){let t=n.get(e);t&&(g(t.node),t.node.parentNode?.removeChild(t.node),n.delete(e))}let h=t;for(let e=0;e<u;e++){let t=s[e],r=f[e],i=n.get(r);if(i)i.item=t,i.index=e,i.indexRef.value=e,h.nextSibling!==i.node&&l.insertBefore(i.node,h.nextSibling);else{let o={value:e},s=()=>o.value,u=c(a(t,s));u instanceof Node&&(i={node:u,item:t,index:e,indexFn:s,indexRef:o},n.set(r,i),l.insertBefore(u,h.nextSibling))}i&&(h=i.node)}r=f};return y(t,()=>_(s)),p(s),o}function P(e){let t=document.createComment(`switch`),n=[],r=-1,i=()=>e.fallback?typeof e.fallback==`function`?c(e.fallback()):c(e.fallback):null,a=()=>{let a=t.parentNode;if(!a)return;let o=-1,s=null,l=Array.isArray(e.children)?e.children:[e.children];for(let e=0;e<l.length;e++){let t=l[e],n=t;if(t&&typeof t==`object`&&t._brand===`component`){let e=t;n=e.type(e.props)}if(n&&typeof n==`object`&&`_isMatch`in n&&n._isMatch){let t=n;if(j(t.when)){o=e;let n=t.children;s=typeof n==`function`?n():n;break}}}if(o!==r){if(n.length>0){for(let e of n)g(e),e.parentNode?.removeChild(e);n=[]}r=o;let e=null;s?e=c(s):o===-1&&(e=i()),e&&(e instanceof DocumentFragment?(n=Array.from(e.childNodes),a.insertBefore(e,t.nextSibling)):e instanceof Node&&(n=[e],a.insertBefore(e,t.nextSibling)))}},o=document.createDocumentFragment();return o.appendChild(t),y(t,()=>_(a)),p(a),o}function F(e){return{_isMatch:!0,when:e.when,children:e.children}}const I=()=>typeof window>`u`?{path:`/`,query:``,hash:``}:{path:window.location.pathname,query:window.location.search,hash:window.location.hash},L=t(I());function R(e){typeof window<`u`&&(window.history.pushState(null,``,e),s(L,I()))}function z(e){let t=()=>s(L,I());return typeof window<`u`&&(window.addEventListener(`popstate`,t),x(()=>window.removeEventListener(`popstate`,t))),e.children}const B=k({}),V=k(new URLSearchParams),H=k(void 0),U=k(null),W=new Map;function G(e){if(!e||typeof e!=`object`)return JSON.stringify(e);let t=Object.keys(e).sort(),n={};for(let r of t)n[r]=e[r];return JSON.stringify(n)}function K(e,t){return`${e}|path=${t.location.path}|query=${t.location.query}|params=${G(t.params)}`}function q(e){for(let t of W.keys())t.startsWith(e+`|`)&&W.delete(t)}const J=q,Y=k(null);function X(){let e=A(Y);e&&W.delete(e)}function Z(e,t){let n=W.get(e);if(n){if(n.status===`fulfilled`)return n.value;throw n.status===`rejected`?n.error:n.promise}let r=Promise.resolve().then(t);throw W.set(e,{status:`pending`,promise:r}),r.then(t=>W.set(e,{status:`fulfilled`,value:t}),t=>W.set(e,{status:`rejected`,error:t})),r}function Q(e,t){if(e===`*`)return{};if(e.endsWith(`*`)){let n=e.slice(0,-1);return t.startsWith(n)?{}:null}let n=e.split(`/`).filter(Boolean),r=t.split(`/`).filter(Boolean);if(n.length!==r.length)return null;let i={};for(let e=0;e<n.length;e++){let t=n[e],a=r[e];if(t.startsWith(`:`)){i[t.slice(1)]=decodeURIComponent(a);continue}if(t!==a)return null}return i}function te(e){let n=e.id||e.path;return M({when:()=>{let t=h(L);return Q(e.path,t.path)!==null},children:()=>{let r=h(L),i=Q(e.path,r.path)||{},a=new URLSearchParams(r.query||``),o={params:i,search:a,location:r},l,u=null;e.loader&&(u=K(n,o),l=Z(u,()=>Promise.resolve(e.loader(o))));let d=t({pending:!1,error:void 0,data:void 0});if(e.action){let t=e.invalidateOnAction??!0;s(d,n=>({...n,run:async r=>{s(d,{pending:!0,error:void 0,data:n.data,run:n.run});try{let n=await e.action(o,r);return s(d,e=>({...e,pending:!1,data:n})),t&&u&&W.delete(u),n}catch(e){throw s(d,t=>({...t,pending:!1,error:e})),e}}}))}let f={run:e=>{let t=h(d);return t.run?t.run(e):Promise.reject(Error(`No action registered for this route`))},pending:()=>h(d).pending,error:()=>h(d).error,data:()=>h(d).data},p=typeof e.children==`function`?e.children(l,{...o,action:f}):e.children;return c({_brand:`component`,type:B.Provider,props:{value:i,children:{_brand:`component`,type:V.Provider,props:{value:a,children:{_brand:`component`,type:H.Provider,props:{value:l,children:{_brand:`component`,type:U.Provider,props:{value:d,children:{_brand:`component`,type:Y.Provider,props:{value:u,children:p}}}}}}}}}})}})}function ne(e){let t=t=>{t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button!==0||(t.preventDefault(),R(e.href))};return v(`a`,{...e,onClick:t},e.children)}function re(e,t){return new Promise((n,r)=>{let i=setTimeout(()=>{t.removeEventListener(`abort`,a),n()},e),a=()=>{clearTimeout(i),r(new DOMException(`Aborted`,`AbortError`))};t.addEventListener(`abort`,a,{once:!0})})}function ie(e,t,n){return typeof e.retryDelayMs==`function`?Math.max(0,e.retryDelayMs(t,n)):typeof e.retryDelayMs==`number`?Math.max(0,e.retryDelayMs):150*t}function ae(e,n,r){let i,a,o=r||{};arguments.length===1?(a=e,i=()=>void 0):arguments.length===2&&typeof n!=`function`?(a=e,i=()=>void 0,o=n||{}):(a=n,i=typeof e==`function`?e:()=>e);let c=Math.max(0,o.retries??0),l=t({value:o.initialValue,loading:!0,error:void 0}),u=null,d=null,f=async e=>{u&&u.abort(),u=new AbortController;let t=u.signal;s(l,e=>({...e,loading:!0,error:void 0}));let n=async()=>{let n=0;for(;;){n+=1;try{return await a(e,{signal:t})}catch(e){if(t.aborted||(o.onError?.(e,n),n>c))throw e;let r=ie(o,n,e);r>0&&await re(r,t)}}};try{let e=n();d=e;let r=await e;if(t.aborted)return;s(l,{value:r,loading:!1,error:void 0})}catch(e){if(t.aborted)return;s(l,t=>({...t,loading:!1,error:e}))}};b(()=>{f(i())}),x(()=>{u&&u.abort()});let p=()=>{let e=h(l);if(e.error)throw e.error;if(e.loading&&d)throw d;return e.value};return p.loading=()=>h(l).loading,p.error=()=>h(l).error,p.refetch=()=>f(i()),p.mutate=e=>s(l,{value:e,loading:!1,error:void 0}),p.state=l,p}const oe=Symbol.for(`vitrio.suspense`),se=Symbol.for(`vitrio.error`),ce=k(void 0,oe);function le(e){let n=t(0),r={increment:()=>s(n,e=>e+1),decrement:()=>s(n,e=>Math.max(0,e-1)),state:n};return{_brand:`component`,type:ce.Provider,props:{value:r,children:()=>{if(h(n)>0)return c(e.fallback);try{return c(e.children)}catch(t){if(t&&typeof t.then==`function`)return r.increment(),t.then(r.decrement,r.decrement),c(e.fallback);throw t}}}}}const ue=k(void 0,se);function de(e){let n=t(null);return{_brand:`component`,type:ue.Provider,props:{value:{handleError:e=>s(n,e)},children:()=>{let t=h(n);if(t){let n=e.fallback;return c(typeof n==`function`?n(t):n)}try{return c(e.children)}catch(t){s(n,t);let r=e.fallback;return c(typeof r==`function`?r(t):r)}}}}}function $(e,t){if(!t)throw Error(`Container element not found`);let n=t._dispose;for(typeof n==`function`&&(n(),t._dispose=void 0);t.firstChild;)g(t.firstChild),t.removeChild(t.firstChild);return l(n=>{t._dispose=n;let r=e;typeof r==`function`&&(r=r());let i=c(r);return i&&t.appendChild(i),n})}const fe=$;function pe(e){if(typeof e!=`string`)return e;let t=e.trim();if(t===``)return t;if(t===`true`)return!0;if(t===`false`)return!1;if(t===`null`)return null;if(t===`undefined`)return;let n=Number(t);return!Number.isNaN(n)&&String(n)===t?n:e}function me(e,t){let n={};for(let[r,i]of e.entries()){let e=i,a=t?pe(e):e;if(r in n){let e=n[r];n[r]=Array.isArray(e)?[...e,a]:[e,a]}else n[r]=a}return n}function he(e){let t=t=>{t.preventDefault();let n;if(e.value!==void 0)n=typeof e.value==`function`?e.value():e.value;else{let r=t.currentTarget;n=me(new FormData(r),e.coerce??!0)}e.action.run(n)},n=e.disabled??!1,r=v(`form`,{onSubmit:t,"aria-busy":()=>e.action.pending()?`true`:`false`,style:()=>e.action.pending()||n?`pointer-events:none;opacity:0.7;`:``},e.children);return e.showError?v(`div`,{},r,()=>{let t=e.action.error();return t?v(`pre`,{style:`color:#b00020;white-space:pre-wrap;margin:0.5rem 0 0;`},t instanceof Error?t.stack||t.message:String(t)):null}):r}export{ne as A,de as ErrorBoundary,N as For,he as Form,F as Match,te as Route,z as Router,M as Show,le as Suspense,P as Switch,m as batch,k as createContext,b as createEffect,ae as createResource,l as createRoot,O as createStore,u as derive,h as get,o as initWasm,J as invalidate,X as invalidateCurrent,q as invalidateRoute,L as location,fe as mount,R as navigate,x as onCleanup,$ as render,s as set,ee as startTransition,i as subscribe,e as untrack,S as use,A as useContext,a as useSet,n as useValue,t as v,r as wasm,p as withRenderContext};
//# sourceMappingURL=index.mjs.map